<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <meta name="description" content="ç§»åŠ¨ç«¯ä¼˜åŒ–çš„è€è™æœºæ¸¸æˆ">
    <title>è€è™æœºæ¸¸æˆ - ç§»åŠ¨ç«¯ä¼˜åŒ–ç‰ˆ</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="game-container">
        <div class="top-info">
            <div id="win-loss-table" class="info-box">
                <h3>è®°å½•</h3>
                <div class="scrollable-content">
                    <table>
                        <thead>
                            <tr>
                                <th>å±€</th>
                                <th>ç»“æœ</th>
                                <th>é‡‘é¢</th>
                                <th>æ—¶é—´</th>
                            </tr>
                        </thead>
                        <tbody id="win-loss-body"></tbody>
                    </table>
                </div>
            </div>

            <div id="jackpot-display" class="info-box jackpot-box">
                <div class="jackpot-label">JACKPOT</div>
                <div id="jackpot-amount" class="jackpot-amount">5000.00</div>
            </div>

            <div id="announcement-board" class="info-box">
                <div id="announcement-content" class="announcement-content">æ¬¢è¿æ¥åˆ°è€è™æœºæ¸¸æˆï¼</div>
            </div>
        </div>

        <div id="reels-section" class="reels-section">
            <div id="reels-container" class="reels-container">
                <div class="reel" data-reel-index="0"><div class="reel-strip"></div></div>
                <div class="reel" data-reel-index="1"><div class="reel-strip"></div></div>
                <div class="reel" data-reel-index="2"><div class="reel-strip"></div></div>
                <div class="reel" data-reel-index="3"><div class="reel-strip"></div></div>
                <div class="reel" data-reel-index="4"><div class="reel-strip"></div></div>
            </div>
            <canvas id="win-lines-canvas"></canvas>
        </div>

        <div id="control-panel" class="control-panel">
            <div class="display-section">
                <div class="display-item">
                    <span class="display-label">ä½™é¢</span>
                    <span id="balance-display" class="display-value">1000.00</span>
                </div>
                <div class="bet-control-group">
                    <button id="btn-bet-down" class="control-btn mini-btn">-</button>
                    <div class="display-item bet-display">
                        <span class="display-label">æŠ¼æ³¨</span>
                        <span id="bet-display" class="display-value">1.00</span>
                    </div>
                    <button id="btn-bet-up" class="control-btn mini-btn">+</button>
                </div>
                <div class="display-item">
                    <span class="display-label">æ€»æŠ¼æ³¨</span>
                    <span id="total-bet-display" class="display-value">25.00</span>
                </div>
                <div class="display-item win-display">
                    <span class="display-label">æœ¬å±€èµ¢å–</span>
                    <span id="win-display" class="display-value win-amount">0.00</span>
                </div>
                <div class="display-item modified-display">
                    <span class="display-label">æ€»è®¡</span>
                    <span id="modified-display" class="display-value total-amount">0.00</span>
                </div>
            </div>

            <div class="action-section">
                <button id="btn-autoplay" class="control-btn secondary-btn" title="è‡ªåŠ¨æ—‹è½¬">
                    <span id="autoplay-display">è‡ªåŠ¨</span>
                    <span id="autoplay-count" class="autoplay-count"></span>
                </button>
                <button id="btn-spin" class="control-btn primary-btn" title="æ—‹è½¬">SPIN</button>
                <button id="btn-stop" class="control-btn secondary-btn hidden" title="åœæ­¢">STOP</button>
                <button id="btn-max-bet" class="control-btn secondary-btn" title="æœ€å¤§æŠ¼æ³¨">MAX BET</button>
            </div>
        </div>

        <div id="free-spins-display" class="free-spins-display hidden">
            å…è´¹æ—‹è½¬: <span id="free-spins-count">0</span>
        </div>

        <div class="settings-bar">
            <button id="btn-paytable" class="settings-btn" title="èµ”ç‡è¡¨">èµ”ç‡è¡¨</button>
            <button id="btn-stats" class="settings-btn" title="ç»Ÿè®¡">ç»Ÿè®¡</button>
            <button id="btn-mute" class="settings-btn" title="é™éŸ³">ğŸ”Š</button>
            <button id="btn-debug" class="settings-btn" title="è°ƒè¯•">âš™ï¸</button>
        </div>
        
        <div id="modal-paytable" class="modal-overlay">
            <div class="modal-content">
                <h3>èµ”ç‡è¡¨</h3>
                <div id="paytable-content" class="paytable-content"></div>
                <button id="btn-close-paytable" class="modal-btn">å…³é—­</button>
            </div>
        </div>
        <div id="modal-stats" class="modal-overlay">
            <div class="modal-content">
                <h3>æ¸¸æˆç»Ÿè®¡</h3>
                <div class="stats-grid">
                    <div class="stat-item"><span class="stat-label">æ€»æ—‹è½¬æ¬¡æ•°</span><span id="stat-total-spins" class="stat-value">0</span></div>
                    <div class="stat-item"><span class="stat-label">æ€»æŠ¼æ³¨</span><span id="stat-total-wagered" class="stat-value">0.00</span></div>
                    <div class="stat-item"><span class="stat-label">æ€»èµ¢å–</span><span id="stat-total-won" class="stat-value">0.00</span></div>
                    <div class="stat-item"><span class="stat-label">ç†è®ºRTP</span><span id="stat-current-rtp" class="stat-value">0%</span></div>
                    <div class="stat-item"><span class="stat-label">æœ€å¤§èµ¢å–</span><span id="stat-biggest-win" class="stat-value">0.00</span></div>
                    <div class="stat-item"><span class=\"stat-label\">ä¸­å¥–ç‡</span><span id=\"stat-hit-rate\" class=\"stat-value\">0%</span></div>
                </div>
                <button id="btn-close-stats" class="modal-btn">å…³é—­</button>
            </div>
        </div>
    </div>

    <script src="js/config.js"></script>
    
    <script src="js/rtp-config.js"></script> 
    
    <script src="js/game-state.js"></script>
    <script src="js/rtp-manager.js"></script>
    <script src="js/audio-manager.js"></script>
    <script src="js/reel-manager.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/game.js"></script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const wakeUpBgMusic = () => {
            const bg = new Audio('music/background/bg.mp3'); // â† åªæ”¹äº†è¿™ä¸€è¡Œ
            bg.loop = true;
            bg.volume = 0.3;
            bg.play().catch(() => {});
            document.removeEventListener('click', wakeUpBgMusic);
            document.removeEventListener('touchstart', wakeUpBgMusic);
        };
        document.addEventListener('click', wakeUpBgMusic, { once: true });
        document.addEventListener('touchstart', wakeUpBgMusic, { once: true });
    });
    </script>


    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/service-worker.js')
                    .then((reg) => {
                        console.log('Service Worker æ³¨å†ŒæˆåŠŸï¼ŒèŒƒå›´æ˜¯:', reg.scope);
                    })
                    .catch((err) => {
                        console.error('Service Worker æ³¨å†Œå¤±è´¥:', err);
                    });
            });
        }
    </script>
    </body>
</html>
