<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="移动端优化的老虎机游戏">
    <title>老虎机游戏 - 移动端优化版</title>
    <link rel="stylesheet" href="style.css">

    <!-- ★★★ 你要求添加的内容（唯一修改） ★★★ -->
    <link rel="manifest" href="/manifest.json">
    <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/sw.js');
    }
    </script>
    <!-- ★★★ 结束 ★★★ -->

</head>
<body>
    <div id="game-container">
        <div class="top-info">
            <div id="win-loss-table" class="info-box">
                <h3>记录</h3>
                <div class="scrollable-content">
                    <table>
                        <thead>
                            <tr>
                                <th>局</th>
                                <th>结果</th>
                                <th>金额</th>
                                <th>时间</th>
                            </tr>
                        </thead>
                        <tbody id="win-loss-body"></tbody>
                    </table>
                </div>
            </div>

            <div id="jackpot-display" class="info-box jackpot-box">
                <div class="jackpot-label">JACKPOT</div>
                <div id="jackpot-amount" class="jackpot-amount">5000.00</div>
            </div>

            <div id="announcement-board" class="info-box">
                <h3>公告</h3>
                <div id="announcement-content" class="scrollable-content">
                    <div class="announcement-item info">欢迎游戏！</div>
                </div>
            </div>
        </div>

        <div id="reels-section">
            <div id="reels-container">
                <canvas id="win-lines-canvas"></canvas>
                <div class="reel" data-reel="0">
                    <div class="reel-viewport">
                        <div class="reel-strip"></div>
                    </div>
                </div>
                <div class="reel" data-reel="1">
                    <div class="reel-viewport">
                        <div class="reel-strip"></div>
                    </div>
                </div>
                <div class="reel" data-reel="2">
                    <div class="reel-viewport">
                        <div class="reel-strip"></div>
                    </div>
                </div>
                <div class="reel" data-reel="3">
                    <div class="reel-viewport">
                        <div class="reel-strip"></div>
                    </div>
                </div>
                <div class="reel" data-reel="4">
                    <div class="reel-viewport">
                        <div class="reel-strip"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="control-panel">
            <div class="panel-inner">
                <div class="display-section">
                    <div class="display-item">
                        <span class="display-label">已修改</span>
                        <span id="modified-display" class="display-value">0.00</span>
                    </div>
                    <div class="display-item">
                        <span class="display-label">线数</span>
                        <div class="bet-controls">
                            <span id="lines-display" class="display-value lines-value">25</span>
                            <button id="btn-switch-lines" class="bet-btn compact-btn">切换</button>
                        </div>
                    </div>
                    <div class="display-item">
                        <span class="display-label">押注</span>
                        <div class="bet-controls">
                            <button id="btn-bet-down" class="bet-btn">-</button>
                            <span id="bet-display" class="display-value">1.00</span>
                            <button id="btn-bet-up" class="bet-btn">+</button>
                        </div>
                    </div>
                    <div class="display-item">
                        <span class="display-label">总注</span>
                        <span id="total-bet-display" class="display-value total-bet">25.00</span>
                    </div>
                    <div class="display-item">
                        <span class="display-label">中奖</span>
                        <span id="win-display" class="display-value win-amount">0.00</span>
                    </div>
                    <div class="display-item">
                        <span class="display-label">余额</span>
                        <span id="balance-display" class="display-value">1000.00</span>
                    </div>
                    <div id="free-spins-display" class="display-item hidden">
                        <span class="display-label">免费</span>
                        <span id="free-spins-count" class="display-value free-spins">0</span>
                    </div>
                    <div id="autoplay-display" class="display-item hidden">
                        <span class="display-label">自动</span>
                        <span id="autoplay-count" class="display-value autoplay-text">0</span>
                    </div>
                </div>

                <div class="button-section">
                    <button id="btn-max-bet" class="control-btn">最大</button>
                    <button id="btn-autoplay" class="control-btn">自动</button>
                    <button id="btn-stop-autoplay" class="control-btn hidden">停止</button>
                    <button id="btn-paytable" class="control-btn">赔付</button>
                    <button id="btn-spin" class="spin-btn">旋转</button>
                </div>
            </div>
        </div>

        <!-- 其余全部保持原样，不再重复 -->

    </div>

    <!-- 游戏脚本（顺序不能变） -->
    <script src="js/config.js"></script>
    <script src="js/game-state.js"></script>
    <script src="js/rtp-manager.js"></script>
    <script src="js/audio-manager.js"></script>
    <script src="js/reel-manager.js"></script>
    <script src="js/ui-manager.js"></script>
    <script src="js/game.js"></script>

    <!-- 背景音乐唤醒：保持不变 -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const wakeUpBgMusic = () => {
            const bg = new Audio('music/background/bg.mp3'); 
            bg.loop = true;
            bg.volume = 0.3;
            bg.play().catch(() => {});
            document.removeEventListener('click', wakeUpBgMusic);
            document.removeEventListener('touchstart', wakeUpBgMusic);
        };
        document.addEventListener('click', wakeUpBgMusic, { once: true });
        document.addEventListener('touchstart', wakeUpBgMusic, { once: true });
    });
    </script>

</body>
</html>
